import{_ as e,o,c,a as n,d as t,b as s,e as p,r as l}from"./app.8b62e66d.js";const u={},k=n("h1",{id:"\u5BF9\u8C61\u6DF1\u62F7\u8D1D",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5BF9\u8C61\u6DF1\u62F7\u8D1D","aria-hidden":"true"},"#"),s(" \u5BF9\u8C61\u6DF1\u62F7\u8D1D")],-1),i=s("\u5982\u679C\u5BF9\u8C61\u53EF\u4EE5\u5E8F\u5217\u5316\uFF0C\u53EF\u4EE5\u4F7F\u7528 "),r={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify",target:"_blank",rel:"noopener noreferrer"},d=n("code",null,"JSON.stringify()",-1),_=s(" \u5C06\u5BF9\u8C61\u8F6C\u6362\u4E3A JSON \u5B57\u7B26\u4E32\uFF0C\u7136\u540E\u4F7F\u7528 "),f={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse",target:"_blank",rel:"noopener noreferrer"},y=n("code",null,"JSON.parse()",-1),h=s(" \u5C06\u5B57\u7B26\u4E32\u8F6C\u6362\u56DE\uFF08\u65B0\u7684\uFF09\u5BF9\u8C61\u3002"),m=p(`<div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">const</span> newObj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>\u8BB8\u591A JavaScript \u5BF9\u8C61\u65E0\u6CD5\u5E8F\u5217\u5316\uFF0C\u4F8B\u5982\u51FD\u6570\u3001\u7B26\u53F7\u3001\u96C6\u5408\u3001Element \u5BF9\u8C61\u7B49\uFF0C\u8FD9\u4E2A\u65F6\u5019\u53EA\u80FD\u6839\u636E\u5BF9\u5E94\u7684\u7C7B\u578B\u91CD\u65B0\u521B\u5EFA\u6570\u636E\u3002\u4E0B\u9762\u7684 deepClone \u65B9\u6CD5\u5B9E\u73B0\u4E86\u51E0\u79CD\u6570\u636E\u7C7B\u578B\u7684\u6DF1\u62F7\u8D1D\uFF1A</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u5982\u679C\u662F\u57FA\u672C\u6570\u636E\u7C7B\u578B\uFF0C\u76F4\u63A5\u8FD4\u56DE\u503C\uFF08\u8FD9\u91CC\u4E0D\u5BF9 symbol \u548C function \u505A\u6DF1\u62F7\u8D1D\uFF0C\u6240\u4EE5\u4E0D\u6392\u9664\uFF09</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">!==</span> <span class="token string">&#39;object&#39;</span> <span class="token operator">||</span> value <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// \u83B7\u53D6\u5BF9\u8C61\u7C7B\u578B</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\\[object ([a-zA-Z]+)\\]$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>
    <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Date\u3001RegExp</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;Date&#39;</span> <span class="token operator">||</span> type <span class="token operator">===</span> <span class="token string">&#39;RegExp&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">value<span class="token punctuation">.</span>constructor</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">value<span class="token punctuation">.</span>constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Set</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;Set&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">deepClone</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Map</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;Map&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> item<span class="token punctuation">]</span> <span class="token keyword">of</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token function">deepClone</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Array\u3001Object</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>value<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>`,3),v=s("\u4F60\u53EF\u4EE5\u6839\u636E\u5B9E\u9645\u9700\u6C42\u589E\u52A0\u5BF9\u5E94\u7684\u6570\u636E\u7C7B\u578B\uFF0C\u6BD4\u5982\uFF1A\u51FD\u6570\u3001\u7B26\u53F7\u3001"),g={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Typed_arrays",target:"_blank",rel:"noopener noreferrer"},w=s("\u7C7B\u578B\u5316\u6570\u7EC4"),b=s("\u7B49\u3002\u53E6\u5916\uFF0C\u5982\u679C\u8981\u6DF1\u62F7\u8D1D\u5FAA\u73AF\u5F15\u7528\u7684\u5BF9\u8C61\uFF0C\u53EF\u4EE5\u5229\u7528 "),S={href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap",target:"_blank",rel:"noopener noreferrer"},j=s("WeakMap"),x=s(" \u7F13\u5B58\u5904\u7406\u8FC7\u7684\u5BF9\u8C61\uFF1A"),O=p(`<div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token comment">// \u5982\u679C\u7F13\u5B58\u91CC\u6709\u8FD9\u4E2A\u5BF9\u8C61\u76F4\u63A5\u8FD4\u56DE\u7ED3\u679C</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>deepClone<span class="token punctuation">.</span>cached<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> deepClone<span class="token punctuation">.</span>cached<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
  deepClone<span class="token punctuation">.</span>cached<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
deepClone<span class="token punctuation">.</span>cached <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>`,1),C={href:"https://stackblitz.com/edit/web-platform-bqr9z1?file=script.js",target:"_blank",rel:"noopener noreferrer"},J=s("\u5728 StackBlitz \u4E2D\u67E5\u770B\u5B8C\u6574\u4EE3\u7801");function N(z,W){const a=l("ExternalLinkIcon");return o(),c("div",null,[k,n("p",null,[i,n("a",r,[d,t(a)]),_,n("a",f,[y,t(a)]),h]),m,n("p",null,[v,n("a",g,[w,t(a)]),b,n("a",S,[j,t(a)]),x]),O,n("p",null,[n("a",C,[J,t(a)])])])}var M=e(u,[["render",N],["__file","deep_copy.html.vue"]]);export{M as default};
